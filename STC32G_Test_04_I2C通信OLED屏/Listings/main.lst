C251 COMPILER V5.60.0,  main                                                               03/04/24  15:03:41  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE main
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE main.c XSMALL INTR2 BROWSE DEBUG PRINT(.\Listings\main.lst) TABS(2) OB
                    -JECT(.\Objects\main.obj) 

stmt  level    source

    1          /*-----------------------------------------------------------------------------------------
    2          
    3          * Ê±ÖÓÑ¡Ôñ 22.1184MHZ
    4          
    5          * ²Î¿¼£ºSTC32GÇý¶¯OLED12864£¬SPI»òI2CÁ½ÖÖ·½Ê½
    6          https://www.stcaimcu.com/forum.php?mod=viewthread&tid=2592
    7          (³ö´¦: ¹úÐ¾ÂÛÌ³-STCÈ«Çò32Î»8051°®ºÃÕß»¥Öú½»Á÷ÉçÇø)
    8          
    9          * ÐÞ¸Ä By PatZer0 @ 2024.03.27
   10              - Í³Ò»ÁËÀàÐÍ¶¨Òå£¬  BYTE/u8/uint8_t -> unsigned char£¬
   11                                  WORD/u16/uint16_t -> unsigned int£¬
   12                                  DWORD/u32/uint32_t -> unsigned long
   13              - ¾«¼òÁËinclude²¿·Ö£¬ÒÆ³ýÁËÎÄ¼þÖÐ·Ç±ØÒªµÄÍ·ÎÄ¼þ£¬·ñÔò±àÒëÊ±ÓÐÌ«¶àwarnings£»
   14          
   15          * ÌáÊ¾£º
   16              - Ä¬ÈÏÊ¹ÓÃP3.2/P3.3¶Ë¿Ú£¬ÐÞ¸ÄÇë¿´ iic.c -> IIC_Init() º¯Êý¡£
   17              - ÈçÐèÌí¼ÓÍ¼Æ¬£¬¿ÉÒÔÊ¹ÓÃ https://javl.github.io/image2cpp/ ½«Í¼Æ¬×ªÎªÊý×é£¬×¢Òâ 
   18                Draw Mode ÐèÒªÎª Vertical£¬·ñÔòÍ¼Æ¬ÏÔÊ¾²»Õý³££¬È»ºóÌí¼Óµ½ pic.h ÖÐ¼´¿É¡£
   19          
   20          * ×¢Òâ£º±¾³ÌÐò½ö¹©Ñ§Ï°²Î¿¼£¬ÇëÎðÓÃÓÚÉÌÒµÓÃÍ¾¡£
   21          -----------------------------------------------------------------------------------------*/
   22          
   23          #include "oled.h"
   24          #include "pic.h"
   25          #include <STC32G.H>
   26          
   27          #define  DELAY_TIME   2000
   28          
   29          // ¶¨Òå°´¼üÒý½Å
   30          sbit key1 = P2^0;
   31          sbit key2 = P2^1;
   32          sbit key3 = P2^2;
   33          sbit key4 = P2^3;
   34          unsigned char key1_up_store = 1; // °´¼ü1×´Ì¬ÔÝ´æ
   35          unsigned char key2_up_store = 1; // °´¼ü2×´Ì¬ÔÝ´æ
   36          unsigned char key3_up_store = 1; // °´¼ü3×´Ì¬ÔÝ´æ
   37          unsigned char key4_up_store = 1; // °´¼ü4×´Ì¬ÔÝ´æ
   38          
   39          unsigned int counter = 0;
   40          unsigned char current_mode = 0;
   41          
   42          void OLED_Loading()
   43          {
   44   1          OLED_BuffClear();                               //Çå³ýÈ«²¿»º´æ
   45   1          OLED_BuffShowString(0,3,"   PLEASE WAIT  ",1);  //ÏÔÊ¾Êý¾Ý
   46   1          OLED_BuffShow();                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
   47   1      }
   48          
   49          void key1_short_press()
   50          {
   51   1          // ¶Ì°´¼ü1¹¦ÄÜ
   52   1          current_mode = 1;
   53   1          OLED_Loading();                                                                 //ÏÔÊ¾¼ÓÔØÖÐ
   54   1          OLED_BuffClear();                                                               //Çå³ýÈ«²¿»º´æ
   55   1          OLED_BuffShowString(0,0,"²âÊÔSTC32G12K128",0);                                  //ÏÔÊ¾Êý¾Ý
   56   1          OLED_BuffShowString(0,2,"The quick brown fox jumps over the lazy dog.",0);      //ÏÔÊ¾Êý¾Ý
   57   1          OLED_BuffShow();                                                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ
             -¾
C251 COMPILER V5.60.0,  main                                                               03/04/24  15:03:41  PAGE 2   

   58   1      }
   59          
   60          void key2_short_press()
   61          {
   62   1          // ¶Ì°´¼ü2¹¦ÄÜ
   63   1          current_mode = 2;
   64   1          OLED_Loading();                                 //ÏÔÊ¾¼ÓÔØÖÐ
   65   1          delay_ms(DELAY_TIME);                           //ÑÓÊ±
   66   1          OLED_BuffClear();                               //Çå³ýÈ«²¿»º´æ
   67   1          OLED_BuffShowBMP(0,0,128,8,OLED12864_ZWU_LOGO); //ÏÔÊ¾LOGOÍ¼Æ¬
*** WARNING C91 IN LINE 67 OF main.c: '&': pointer to different objects
   68   1          OLED_BuffShow();                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
   69   1          delay_ms(DELAY_TIME);                           //ÑÓÊ±
   70   1      }
   71          
   72          void key3_short_press()
   73          {
   74   1          // ¶Ì°´¼ü3¹¦ÄÜ
   75   1          if (current_mode != 3)
   76   1          {
   77   2              // µ±Ç°²»ÔÚ¼ÆÊýÆ÷Ä£Ê½£¬³õÊ¼»¯
   78   2              OLED_Loading();                                 //ÏÔÊ¾¼ÓÔØÖÐ
   79   2              // ÏÔÊ¾¼ÆÊ±Æ÷UI
   80   2              OLED_BuffClear();                               //Çå³ýÈ«²¿»º´æ
   81   2              OLED_BuffShowString(0,0,"[Simple Counter]",0);  //ÏÔÊ¾Êý¾Ý
   82   2              OLED_BuffShowString(0,3,"   Press Key3",0);     //ÏÔÊ¾Êý¾Ý
   83   2              OLED_BuffShow();                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
   84   2              counter = 0;                                    //¼ÆÊýÆ÷ÇåÁã
   85   2              current_mode = 3;                               //½øÈë¼ÆÊýÆ÷Ä£Ê½
   86   2          }
   87   1          else
   88   1          {
   89   2              counter++;                                      //¼ÆÊýÆ÷¼Ó1
   90   2              if (counter > 9) counter = 0;                   //¼ÆÊýÆ÷Òç³ö
   91   2              OLED_BuffClear();                               //Çå³ýÈ«²¿»º´æ
   92   2              OLED_BuffShowString(0,0,"[Simple Counter]",0);  //ÏÔÊ¾Êý¾Ý
   93   2              OLED_BuffShowChar32(58,3,counter,0);            //ÏÔÊ¾Êý×Ö
*** WARNING C188 IN LINE 93 OF main.c: 'parameter 3': value truncated
   94   2              OLED_BuffShow();                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
   95   2          }
   96   1      }
   97          
   98          void key4_short_press()
   99          {
  100   1          // ¶Ì°´¼ü4¹¦ÄÜ
  101   1          current_mode = 4;
  102   1      }
  103          
  104          void key1_check() 
  105          {
  106   1          if(key1 == 0 && key1_up_store == 1)
  107   1          {
  108   2              key1_up_store = 0; // ±ê¼Ç°´¼ü±»°´ÏÂ
  109   2          }
  110   1          if(key1 == 1 && key1_up_store == 0)
  111   1          {
  112   2              key1_up_store = 1; // ±ê¼Ç°´¼ü±»ÊÍ·Å
  113   2              key1_short_press(); // ´¥·¢¶Ì°´¼ü1¹¦ÄÜ
  114   2          }
  115   1      }
  116          
  117          void key2_check()
  118          {
  119   1          if(key2 == 0 && key2_up_store == 1)
  120   1          {
  121   2              key2_up_store = 0; // ±ê¼Ç°´¼ü±»°´ÏÂ
C251 COMPILER V5.60.0,  main                                                               03/04/24  15:03:41  PAGE 3   

  122   2          }
  123   1          if(key2 == 1 && key2_up_store == 0)
  124   1          {
  125   2              key2_up_store = 1; // ±ê¼Ç°´¼ü±»ÊÍ·Å
  126   2              key2_short_press(); // ´¥·¢¶Ì°´¼ü2¹¦ÄÜ
  127   2          }
  128   1      }
  129          
  130          void key3_check()
  131          {
  132   1          if(key3 == 0 && key3_up_store == 1)
  133   1          {
  134   2              key3_up_store = 0; // ±ê¼Ç°´¼ü±»°´ÏÂ
  135   2          }
  136   1          if(key3 == 1 && key3_up_store == 0)
  137   1          {
  138   2              key3_up_store = 1; // ±ê¼Ç°´¼ü±»ÊÍ·Å
  139   2              key3_short_press(); // ´¥·¢¶Ì°´¼ü3¹¦ÄÜ
  140   2          }
  141   1      }
  142          
  143          void key4_check()
  144          {
  145   1          if(key4 == 0 && key4_up_store == 1)
  146   1          {
  147   2              key4_up_store = 0; // ±ê¼Ç°´¼ü±»°´ÏÂ
  148   2          }
  149   1          if(key4 == 1 && key4_up_store == 0)
  150   1          {
  151   2              key4_up_store = 1; // ±ê¼Ç°´¼ü±»ÊÍ·Å
  152   2              key4_short_press(); // ´¥·¢¶Ì°´¼ü4¹¦ÄÜ
  153   2          }
  154   1      }
  155          
  156          void sys_init()
  157          {
  158   1          WTST = 0;  //ÉèÖÃ³ÌÐòÖ¸ÁîÑÓÊ±²ÎÊý£¬¸³ÖµÎª0¿É½«CPUÖ´ÐÐÖ¸ÁîµÄËÙ¶ÈÉèÖÃÎª×î¿ì
  159   1          EAXFR = 1; //À©Õ¹¼Ä´æÆ÷(XFR)·ÃÎÊÊ¹ÄÜ
  160   1          CKCON = 0; //Ìá¸ß·ÃÎÊXRAMËÙ¶È
  161   1      
  162   1          P0M1 = 0x00;   P0M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  163   1          P1M1 = 0x00;   P1M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  164   1          P2M1 = 0x00;   P2M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  165   1          P3M1 = 0x00;   P3M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  166   1          P4M1 = 0x00;   P4M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  167   1          P5M1 = 0x00;   P5M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  168   1          P6M1 = 0x00;   P6M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  169   1          P7M1 = 0x00;   P7M0 = 0x00;   //ÉèÖÃÎª×¼Ë«Ïò¿Ú
  170   1      }
  171          
  172          void main(void)
  173          {
  174   1          unsigned char i;
  175   1          float dat = -12.345;
  176   1      
  177   1          sys_init();                         //ÏµÍ³³õÊ¼»¯
  178   1          EA = 1;                             //¿ª×ÜÖÐ¶Ï
  179   1          OLED_Init();                        //OLED³õÊ¼»¯
  180   1      
  181   1          OLED_BuffClear();                               //Çå³ýÈ«²¿»º´æ
  182   1          OLED_BuffShowString(0,0,"Press any key to",0);  //ÏÔÊ¾Êý¾Ý
  183   1          OLED_BuffShowString(0,2,"start...",0);          //ÏÔÊ¾Êý¾Ý
  184   1          OLED_BuffShow();                                //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  185   1      
  186   1          while (1)
  187   1          {
C251 COMPILER V5.60.0,  main                                                               03/04/24  15:03:41  PAGE 4   

  188   2              key1_check();                    //¼ì²é°´¼ü1
  189   2              key2_check();                    //¼ì²é°´¼ü2
  190   2              key3_check();                    //¼ì²é°´¼ü3
  191   2              key4_check();                    //¼ì²é°´¼ü4
  192   2      
  193   2      // =============================================================================================
  194   2      // ÒÔÏÂ¾ùÎªÔ´´úÂë×Ô´øµÄ²âÊÔ´úÂë£¬ÈçÐèÒªÊ¹ÓÃ¿ÉÒÔÈ¡Ïû×¢ÊÍ
  195   2      // //-----------------------------------------ÏÔÊ¾Í¼Æ¬-----------------------------------------   
  196   2          // OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  197   2          // OLED_BuffShowBMP(0,0,128,8,OLED12864_IMG);                              //ÏÔÊ¾LOGOÍ¼Æ¬
  198   2          // OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  199   2          // delay_ms(DELAY_TIME);                                                   //ÑÓÊ± 
  200   2      
  201   2      // //-----------------------------------------ÏÔÊ¾×Ö·û-----------------------------------------   
  202   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  203   2      //     OLED_BuffShowString(0,0,"HEELO ,WELCOME TO USE STC32&OLED12864!",0);    //ÏÔÊ¾Êý¾Ý
  204   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  205   2      //     delay_ms(DELAY_TIME);                                                   //ÑÓÊ± 
  206   2          
  207   2      // //-----------------------------------------ÏÔÊ¾ºº×Ö-----------------------------------------   
  208   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  209   2      //     OLED_BuffShowString(0,0,"ÄãºÃ,»¶Ó­Ê¹ÓÃSTC Çý\xfd¶¯OLED12864µÄÀú³Ì",0);  //ÏÔÊ¾Êý¾Ý
  210   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  211   2      //     delay_ms(DELAY_TIME);                                                   //ÑÓÊ±        
  212   2          
  213   2      // //-----------------------------------------ÏÔÊ¾µã-----------------------------------------   
  214   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  215   2      //     OLED_BuffShowString(32,0,"»­µã²âÊÔ");                                   //ÏÔÊ¾Êý¾Ý
  216   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾ 
  217   2      //     for( i=0;i<64;i++ )                                                     //Ñ­»·64´Î
  218   2      //     {
  219   2      //         OLED_BuffShowPoint(i*2,25);                                         //ÏÔÊ¾Ò»¸öµã
  220   2      //         OLED_BuffShow();                                                    //Ë¢ÐÂÏÔÊ¾
  221   2      //         delay_ms(50);                                                       //ÑÓÊ±
  222   2      //     }
  223   2          
  224   2      // //-----------------------------------------ÏÔÊ¾Ïß-----------------------------------------   
  225   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  226   2      //     OLED_BuffShowString(32,0,"»­Ïß²âÊÔ");                                   //ÏÔÊ¾Êý¾Ý
  227   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾ 
  228   2      //     for( i=0;i<6;i++ )                                                      //Ñ­»·6´Î
  229   2      //     {
  230   2      //         OLED_BuffShowLine(4,16+8*i,124,16+8*i);                             //ÏÔÊ¾ºá×Å6ÌõÏß
  231   2      //         OLED_BuffShow();                                                    //Ë¢ÐÂÏÔÊ¾
  232   2      //         delay_ms(100);
  233   2      //     }        
  234   2      //     for( i=0;i<16;i+=1 )                                                    //Ñ­»·16´Î
  235   2      //     {
  236   2      //         OLED_BuffShowLine(8*i+4,16,8*i+4,56);                               //ÏÔÊ¾16ÌõÊýÏß
  237   2      //         OLED_BuffShow();                                                    //Ë¢ÐÂÏÔÊ¾
  238   2      //         delay_ms(100);
  239   2      //     }  
  240   2      
  241   2      // //-----------------------------------------ÏÔÊ¾Ô²-----------------------------------------   
  242   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  243   2      //     OLED_BuffShowString(32,0,"»­Ô²²âÊÔ");                                   //ÏÔÊ¾Êý¾Ý
  244   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾ 
  245   2      //     for( i=0;i<6;i++ )                                                      //Ñ­»·6´Î
  246   2      //     {
  247   2      //        OLED_BuffShowCircle(64,40,5+i*3);                                    //»­Ò»¸öÔ²    
  248   2      //         OLED_BuffShow();                                                    //Ë¢ÐÂÏÔÊ¾
  249   2      //         delay_ms(250);
  250   2      //     }         
  251   2      
  252   2      // //-----------------------------------------ÏÔÊ¾32´ó×Ö-----------------------------------------   
  253   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
C251 COMPILER V5.60.0,  main                                                               03/04/24  15:03:41  PAGE 5   

  254   2      //     OLED_BuffShowString(32,0,"´ó×Ö²âÊÔ");                                   //ÏÔÊ¾Êý¾Ý
  255   2      //     OLED_BuffShowChar32(24,3,1,0);                                          //ÏÔÊ¾Êý×Ö1
  256   2      //     OLED_BuffShowChar32(40,3,0,0);                                          //ÏÔÊ¾Êý×Ö0
  257   2      //     OLED_BuffShowChar32(56,3,10,0);                                         //ÏÔÊ¾£º
  258   2      //     OLED_BuffShowChar32(72,3,5,0);                                          //ÏÔÊ¾Êý×Ö5
  259   2      //     OLED_BuffShowChar32(88,3,5,0);                                          //ÏÔÊ¾Êý×Ö5
  260   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾ 
  261   2      //     delay_ms(DELAY_TIME);                                                   //ÑÓÊ±  
  262   2      
  263   2      // //-----------------------------------------·´ÏÔ²âÊÔ-----------------------------------------   
  264   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  265   2      //     OLED_BuffShowString(32,0,"·´ÏÔ²âÊÔ",0);                                 //ÏÔÊ¾Êý¾Ý
  266   2      //     OLED_BuffShowString(16,2,"  ÕâÊÇÕý\xfdÏÔ  ",0);                         //ÏÔÊ¾Êý¾Ý
  267   2      //     OLED_BuffShowString(16,4,"  ÕâÊÇ·´ÏÔ  ",1);                             //ÏÔÊ¾Êý¾Ý
  268   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  269   2      //     delay_ms(DELAY_TIME);   
  270   2      
  271   2      // //-----------------------------------------±äÁ¿ÏÔÊ¾-----------------------------------------   
  272   2      //     OLED_BuffClear();                                                       //Çå³ýÈ«²¿»º´æ
  273   2      //     OLED_BuffShowString(32,0,"±äÁ¿ÏÔÊ¾",0);                                 //ÏÔÊ¾Êý¾Ý
  274   2      //     OLED_BuffShowNum(0,2,-25169,0) ;                                        //ÏÔÊ¾Êý¾Ý
  275   2      //     OLED_BuffShowNum02F(0,4,3.14159,0);                                     //ÏÔÊ¾Êý¾Ý
  276   2      //     OLED_BuffShowNum02F(0,6,dat,1);                                         //ÏÔÊ¾Êý¾Ý
  277   2      //     OLED_BuffShow();                                                        //½«»º´æÐ´ÈëÏÔÊ¾ÆÁÏÔÊ¾
  278   2      //     delay_ms(DELAY_TIME);   
  279   2          }
  280   1      }
*** WARNING C47 IN LINE 174 OF main.c: 'i': unreferenced local variable


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      3607     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =         7     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =       167     ------
End of Module Information.


C251 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
