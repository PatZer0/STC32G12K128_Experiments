C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE oled
OBJECT MODULE PLACED IN .\Objects\oled.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE oled.c XSMALL INTR2 BROWSE DEBUG PRINT(.\Listings\oled.lst) TABS(2) OB
                    -JECT(.\Objects\oled.obj) 

stmt  level    source

    1          #include "oled.h"
    2          #include "font.h"
    3          #include <STDIO.H>
    4          #include <STC32G.H>
    5          #include <STRING.H>
    6          
    7          unsigned char xdata ShowBUFF[8][128];                           //OLEDå…¨å±€ç¼“å­˜
    8          
    9          //========================================================================
   10          // å‡½æ•°åç§°: delay
   11          // å‡½æ•°åŠŸèƒ½: OLEDé©±åŠ¨ç”¨çš„å»¶æ—¶
   12          // å…¥å£å‚æ•°: æ— 
   13          // å‡½æ•°è¿”å›: æ— 
   14          // å½“å‰ç‰ˆæœ¬: VER1.0
   15          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
   16          // å½“å‰ä½œè€…: ZCF
   17          // å…¶ä»–å¤‡æ³¨:
   18          //========================================================================
   19          void delay(void)
   20          {
   21   1          int xdata i;
   22   1          
   23   1          for (i=0; i<100; i++);
   24   1      }
   25          
   26          //========================================================================
   27          // å‡½æ•°åç§°: delay_ms
   28          // å‡½æ•°åŠŸèƒ½: mså»¶æ—¶å‡½æ•°
   29          // å…¥å£å‚æ•°: æ— 
   30          // å‡½æ•°è¿”å›: æ— 
   31          // å½“å‰ç‰ˆæœ¬: VER1.0
   32          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
   33          // å½“å‰ä½œè€…: ZCF
   34          // å…¶ä»–å¤‡æ³¨:
   35          //========================================================================
   36          void delay_ms(unsigned int ms)
   37          {
   38   1           unsigned int xdata i;
   39   1           do{
   40   2                i = MAIN_Fosc / 6000;
   41   2                while(--i);   //6T per loop
   42   2           }while(--ms);
   43   1      }
   44          
   45          //========================================================================
   46          // å‡½æ•°åç§°: OLED_WR_Byte
   47          // å‡½æ•°åŠŸèƒ½: OLEDåœ°å€/æ•°æ®å†™å…¥å‡½æ•°
   48          // å…¥å£å‚æ•°: @dat:æ•°æ®    @cmd:å‘½ä»¤
   49          // å‡½æ•°è¿”å›: æ— 
   50          // å½“å‰ç‰ˆæœ¬: VER1.0
   51          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
   52          // å½“å‰ä½œè€…: ZCF
   53          // å…¶ä»–å¤‡æ³¨:
   54          //========================================================================
   55          void OLED_WR_Byte(unsigned char dat,unsigned char cmd)
   56          {
   57   1          unsigned char udat[1] ;
   58   1          udat[0] = dat;
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 2   

   59   1          if( cmd==1 )
   60   1              IIC_Write_NByte(0X78,0x40,udat,1);
   61   1          else
   62   1              IIC_Write_NByte(0X78,0x00,udat,1);
   63   1      }
   64          
   65          //========================================================================
   66          // å‡½æ•°åç§°: OLED_Init
   67          // å‡½æ•°åŠŸèƒ½: OLEDåˆå§‹åŒ–å‡½æ•°
   68          // å…¥å£å‚æ•°: æ— 
   69          // å‡½æ•°è¿”å›: æ— 
   70          // å½“å‰ç‰ˆæœ¬: VER1.0
   71          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
   72          // å½“å‰ä½œè€…: ZCF
   73          // å…¶ä»–å¤‡æ³¨:
   74          //========================================================================
   75          void OLED_Init(void)
   76          {
   77   1          IIC_Init();
   78   1          delay_ms(100);
   79   1          delay_ms(200);
   80   1      
   81   1      
   82   1          OLED_WR_Byte(0xAE,OLED_CMD);//--turn off oled panel
   83   1          OLED_WR_Byte(0x00,OLED_CMD);//---set low column address
   84   1          OLED_WR_Byte(0x10,OLED_CMD);//---set high column address
   85   1          OLED_WR_Byte(0x40,OLED_CMD);//--set start line address  Set Mapping RAM Display Start Line (0x00~0x3F
             -)
   86   1          OLED_WR_Byte(0x81,OLED_CMD);//--set contrast control register
   87   1          OLED_WR_Byte(0xCF,OLED_CMD);// Set SEG Output Current Brightness
   88   1          OLED_WR_Byte(0xA1,OLED_CMD);//--Set SEG/Column Mapping     0xa0å·¦å³åç½® 0xa1æ­£å¸¸
   89   1          OLED_WR_Byte(0xC8,OLED_CMD);//Set COM/Row Scan Direction   0xc0ä¸Šä¸‹åç½® 0xc8æ­£å¸¸
   90   1          OLED_WR_Byte(0xA6,OLED_CMD);//--set normal display
   91   1          OLED_WR_Byte(0xA8,OLED_CMD);//--set multiplex ratio(1 to 64)
   92   1          OLED_WR_Byte(0x3f,OLED_CMD);//--1/64 duty
   93   1          OLED_WR_Byte(0xD3,OLED_CMD);//-set display offset Shift Mapping RAM Counter (0x00~0x3F)
   94   1          OLED_WR_Byte(0x00,OLED_CMD);//-not offset
   95   1          OLED_WR_Byte(0xd5,OLED_CMD);//--set display clock divide ratio/oscillator frequency
   96   1          OLED_WR_Byte(0x80,OLED_CMD);//--set divide ratio, Set Clock as 100 Frames/Sec
   97   1          OLED_WR_Byte(0xD9,OLED_CMD);//--set pre-charge period
   98   1          OLED_WR_Byte(0xF1,OLED_CMD);//Set Pre-Charge as 15 Clocks & Discharge as 1 Clock
   99   1          OLED_WR_Byte(0xDA,OLED_CMD);//--set com pins hardware configuration
  100   1          OLED_WR_Byte(0x12,OLED_CMD);
  101   1          OLED_WR_Byte(0xDB,OLED_CMD);//--set vcomh
  102   1          OLED_WR_Byte(0x40,OLED_CMD);//Set VCOM Deselect Level
  103   1          OLED_WR_Byte(0x20,OLED_CMD);//-Set Page Addressing Mode (0x00/0x01/0x02)
  104   1          OLED_WR_Byte(0x02,OLED_CMD);//
  105   1          OLED_WR_Byte(0x8D,OLED_CMD);//--set Charge Pump enable/disable
  106   1          OLED_WR_Byte(0x14,OLED_CMD);//--set(0x10) disable
  107   1          OLED_WR_Byte(0xA4,OLED_CMD);// Disable Entire Display On (0xa4/0xa5)
  108   1          OLED_WR_Byte(0xA6,OLED_CMD);// Disable Inverse Display On (0xa6/a7) 
  109   1          OLED_WR_Byte(0xAF,OLED_CMD);
  110   1          OLED_BuffClear();
  111   1          OLED_BuffShow();
  112   1          OLED_DisplayOn();
  113   1      }
  114          
  115          
  116          //========================================================================
  117          // å‡½æ•°åç§°: OLED_Set_Pos
  118          // å‡½æ•°åŠŸèƒ½: OLEDè®¾ç½®æ˜¾ç¤ºä½ç½®
  119          // å…¥å£å‚æ•°: @x:xåæ ‡     @y:yåæ ‡
  120          // å‡½æ•°è¿”å›: æ— 
  121          // å½“å‰ç‰ˆæœ¬: VER1.0
  122          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  123          // å½“å‰ä½œè€…: ZCF
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 3   

  124          // å…¶ä»–å¤‡æ³¨:
  125          //========================================================================
  126          void OLED_Set_Pos(unsigned char x, unsigned char y) 
  127          { 
  128   1        OLED_WR_Byte((unsigned char)(0xb0+y),OLED_CMD);
  129   1        OLED_WR_Byte(((x&0xf0)>>4)|0x10,OLED_CMD);
  130   1        OLED_WR_Byte((x&0x0f),OLED_CMD); 
  131   1      }   
  132          
  133          
  134          //========================================================================
  135          // å‡½æ•°åç§°: OLED_DrawBMP
  136          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºå›¾ç‰‡
  137          // å…¥å£å‚æ•°: @x0:xèµ·ç‚¹  @y0:yèµ·ç‚¹    @x1:xç»ˆç‚¹   @y1:yç»ˆç‚¹  @BMPï¼šæ˜¾ç¤ºæ•°ç»„
  138          // å‡½æ•°è¿”å›: æ— 
  139          // å½“å‰ç‰ˆæœ¬: VER1.0
  140          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  141          // å½“å‰ä½œè€…: ZCF
  142          // å…¶ä»–å¤‡æ³¨:
  143          //========================================================================
  144          void OLED_DrawBMP(unsigned char x0, unsigned char y0,unsigned char x1, unsigned char y1,unsigned char BMP
             -[])
  145          {   
  146   1          unsigned int xdata j=0;
  147   1          unsigned char xdata x,y;
  148   1      
  149   1          for(y=y0;y<(y1+y0);y++)
  150   1          {
  151   2              OLED_Set_Pos(x0,y);
  152   2              for(x=0;x<x1;x++)
  153   2              {      
  154   3                  OLED_WR_Byte(BMP[j++],OLED_DATA);       
  155   3              }
  156   2          }
  157   1      } 
  158          
  159          //========================================================================
  160          // å‡½æ•°åç§°: OLED_DisplayOn
  161          // å‡½æ•°åŠŸèƒ½: OLEDå¼€æ˜¾ç¤º
  162          // å…¥å£å‚æ•°: æ— 
  163          // å‡½æ•°è¿”å›: æ— 
  164          // å½“å‰ç‰ˆæœ¬: VER1.0
  165          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  166          // å½“å‰ä½œè€…: ZCF
  167          // å…¶ä»–å¤‡æ³¨:
  168          //========================================================================
  169          void OLED_DisplayOn(void)     //å¼€æ˜¾ç¤º
  170          {
  171   1          OLED_WR_Byte(0x8D,OLED_CMD);//ç”µè·æ³µä½¿èƒ½
  172   1          OLED_WR_Byte(0x14,OLED_CMD);//å¼€å¯ç”µè·æ³µ
  173   1          OLED_WR_Byte(0xAF,OLED_CMD);//ç‚¹äº®å±å¹•       
  174   1      }
  175            
  176          //========================================================================
  177          // å‡½æ•°åç§°: OLED_DisplayOff
  178          // å‡½æ•°åŠŸèƒ½: OLEDå…³æ˜¾ç¤º
  179          // å…¥å£å‚æ•°: æ— 
  180          // å‡½æ•°è¿”å›: æ— 
  181          // å½“å‰ç‰ˆæœ¬: VER1.0
  182          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  183          // å½“å‰ä½œè€…: ZCF
  184          // å…¶ä»–å¤‡æ³¨:
  185          //========================================================================
  186          void OLED_DisplayOff(void)     //å…³æ˜¾ç¤º
  187          {
  188   1          OLED_WR_Byte(0x8D,OLED_CMD);//ç”µè·æ³µä½¿èƒ½
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 4   

  189   1          OLED_WR_Byte(0x10,OLED_CMD);//å…³é—­ç”µè·æ³µ
  190   1          OLED_WR_Byte(0xAF,OLED_CMD);//å…³é—­å±å¹•        
  191   1      }
  192          
  193          //========================================================================
  194          // å‡½æ•°åç§°: OLED_LightSet
  195          // å‡½æ•°åŠŸèƒ½: OLEDäº®åº¦è®¾ç½®
  196          // å…¥å£å‚æ•°: @numï¼š 0-255
  197          // å‡½æ•°è¿”å›: æ— 
  198          // å½“å‰ç‰ˆæœ¬: VER1.0
  199          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  200          // å½“å‰ä½œè€…: ZCF
  201          // å…¶ä»–å¤‡æ³¨:
  202          //========================================================================
  203          void OLED_LightSet(unsigned char num)     //äº®åº¦è®¾ç½®
  204          {
  205   1          OLED_WR_Byte(0x81,OLED_CMD);//
  206   1          OLED_WR_Byte(num,OLED_CMD);//  
  207   1          OLED_WR_Byte(0xDB,OLED_CMD);//--set vcomh
  208   1          OLED_WR_Byte(0x20,OLED_CMD);//Set VCOM Deselect Level   
  209   1      }
  210          
  211          
  212          //========================================================================
  213          // å‡½æ•°åç§°: OLED_BuffClear
  214          // å‡½æ•°åŠŸèƒ½: OLEDæ¸…ç©ºç¼“å­˜
  215          // å…¥å£å‚æ•°: æ— 
  216          // å‡½æ•°è¿”å›: æ— 
  217          // å½“å‰ç‰ˆæœ¬: VER1.0
  218          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  219          // å½“å‰ä½œè€…: ZCF
  220          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  221          //========================================================================
  222          void OLED_BuffClear(void)     //æ¸…å±
  223          {
  224   1          memset(ShowBUFF,0,128*8);
  225   1      }
  226          
  227          //========================================================================
  228          // å‡½æ•°åç§°: OLED_BuffShow
  229          // å‡½æ•°åŠŸèƒ½: OLEDåˆ·æ–°æ˜¾ç¤º
  230          // å…¥å£å‚æ•°: æ— 
  231          // å‡½æ•°è¿”å›: æ— 
  232          // å½“å‰ç‰ˆæœ¬: VER1.0
  233          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  234          // å½“å‰ä½œè€…: ZCF
  235          // å…¶ä»–å¤‡æ³¨:
  236          //========================================================================
  237          void OLED_BuffShow(void)     
  238          {
  239   1          unsigned char xdata i,n,j;
  240   1          for(i=0;i<8;i++)
  241   1          {
  242   2              j = 0xb0 + i;             //C251æ›´åŠ ä¸¥è°¨ï¼Œè¿™æ ·å†™ä»¥é¿å…warning
  243   2              OLED_WR_Byte(j,OLED_CMD); //è®¾ç½®è¡Œèµ·å§‹åœ°å€
  244   2              OLED_WR_Byte(0x02,OLED_CMD);   //è®¾ç½®ä½åˆ—èµ·å§‹åœ°å€    // 2024.03.27ä¿®æ”¹ä½åˆ—èµ·å§‹ï¼Œå
             -¦åˆ™æµ‹è¯•ç”¨å±å¹•æ˜¾ç¤ºä¸å…¨
  245   2              OLED_WR_Byte(0x10,OLED_CMD);   //è®¾ç½®é«˜åˆ—èµ·å§‹åœ°å€
  246   2      
  247   2              for(n=0;n<128;n++)
  248   2                  OLED_WR_Byte(ShowBUFF[i][n],OLED_DATA);
  249   2          }
  250   1      }
  251          
  252          //========================================================================
  253          // å‡½æ•°åç§°: OLED_BuffShowPoint
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 5   

  254          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€ä¸ªç‚¹
  255          // å…¥å£å‚æ•°: @xï¼šxèµ·ç‚¹   @y:yèµ·ç‚¹
  256          // å‡½æ•°è¿”å›: æ— 
  257          // å½“å‰ç‰ˆæœ¬: VER1.0
  258          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  259          // å½“å‰ä½œè€…: ZCF
  260          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  261          //========================================================================
  262          void OLED_BuffShowPoint(unsigned char x,unsigned char y)     //OLEDæ˜¾ç¤ºä¸€ä¸ªç‚¹
  263          {
  264   1          ShowBUFF[y/8][x] |= 1<<(y%8);
  265   1      }
  266          
  267          //========================================================================
  268          // å‡½æ•°åç§°: OLED_BuffShowPoint
  269          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€æ¡çº¿
  270          // å…¥å£å‚æ•°: @x1ï¼šxèµ·ç‚¹  @y1ï¼šyèµ·ç‚¹  @x2ï¼šxç»ˆç‚¹   @y2ï¼šyç»ˆç‚¹
  271          // å‡½æ•°è¿”å›: æ— 
  272          // å½“å‰ç‰ˆæœ¬: VER1.0
  273          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  274          // å½“å‰ä½œè€…: ZCF
  275          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  276          //========================================================================
  277          void OLED_BuffShowLine( unsigned char x1, unsigned char y1, unsigned char x2,unsigned char y2)
  278          {
  279   1          unsigned char x,y;
  280   1          if( x1>x2 )
  281   1          {
  282   2              x=x1;x1=x2;x2=x;
  283   2              y=y1;y1=y2;y2=y;
  284   2          }
  285   1          if(x1!=x2)
  286   1          {
  287   2              for( x = x1; x <= x2; x++ )
  288   2              {
  289   3                  if( y2>y1 )
  290   3                      OLED_BuffShowPoint(x, (unsigned char)(y1+(unsigned int)(y2-y1)*(unsigned int)x/(unsigned 
             -int)(x2-x1)));
  291   3                  else
  292   3                      OLED_BuffShowPoint(x, (unsigned char)(y1-(unsigned int)(y1-y2)*(unsigned int)x/(unsigned 
             -int)(x2-x1)));
  293   3              }        
  294   2          }
  295   1          else
  296   1          {
  297   2              if( y1>y2 )
  298   2              {
  299   3                  for( y = y2; y <= y1; y++ )
  300   3                     OLED_BuffShowPoint(x1, y); 
  301   3              }
  302   2              else
  303   2              {
  304   3                  for( y = y1; y <= y2; y++ )
  305   3                     OLED_BuffShowPoint(x1, y);             
  306   3              }
  307   2          }
  308   1      }
  309          
  310          //========================================================================
  311          // å‡½æ•°åç§°: OLED_BuffShowRectangle
  312          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€ä¸ªçŸ©å½¢
  313          // å…¥å£å‚æ•°: @x1ï¼šxèµ·ç‚¹  @y1ï¼šyèµ·ç‚¹  @x2ï¼šxç»ˆç‚¹   @y2ï¼šyç»ˆç‚¹
  314          // å‡½æ•°è¿”å›: æ— 
  315          // å½“å‰ç‰ˆæœ¬: VER1.0
  316          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  317          // å½“å‰ä½œè€…: ZCF
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 6   

  318          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  319          //========================================================================
  320          void OLED_BuffShowRectangle(unsigned char x1, unsigned char y1, unsigned char x2, unsigned char y2)
  321          {
  322   1          OLED_BuffShowLine(x1, y1, x2, y1);
  323   1          OLED_BuffShowLine(x1, y1, x1, y2);
  324   1          OLED_BuffShowLine(x1, y2, x2, y2);
  325   1          OLED_BuffShowLine(x2, y1, x2, y2);
  326   1      }
  327          
  328          //========================================================================
  329          // å‡½æ•°åç§°: OLED_BuffShowCircle
  330          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€ä¸ªåœ†å½¢
  331          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @r:åŠå¾„
  332          // å‡½æ•°è¿”å›: æ— 
  333          // å½“å‰ç‰ˆæœ¬: VER1.0
  334          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  335          // å½“å‰ä½œè€…: ZCF
  336          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  337          //========================================================================
  338          void OLED_BuffShowCircle(unsigned char x, unsigned char y, unsigned char r)
  339          {
  340   1          int a, b;
  341   1          int di;
  342   1          unsigned char x_add_a, x_add_b, x_sub_a, x_sub_b, y_add_a, y_add_b, y_sub_a, y_sub_b;
  343   1      
  344   1          a = 0;
  345   1          b = r;
  346   1          di = 3 - (r << 1);       //åˆ¤æ–­ä¸‹ä¸ªç‚¹ä½ç½®çš„æ ‡å¿—
  347   1       
  348   1          while (a <= b)
  349   1          {
  350   2              x_add_a = x + a;
  351   2              x_add_b = x + b;
  352   2              x_sub_a = x - a;
  353   2              x_sub_b = x - b;
  354   2              y_add_a = y + a;
  355   2              y_add_b = y + b;
  356   2              y_sub_a = y - a;
  357   2              y_sub_b = y - b;
  358   2              OLED_BuffShowPoint(x_add_a, y_sub_b);        //5
  359   2              OLED_BuffShowPoint(x_add_b, y_sub_a);        //0
  360   2              OLED_BuffShowPoint(x_sub_b, y_add_a);        //4
  361   2              OLED_BuffShowPoint(x_sub_a, y_add_b);        //6
  362   2              OLED_BuffShowPoint(x_sub_a, y_sub_b);        //1
  363   2              OLED_BuffShowPoint(x_add_b, y_add_a);
  364   2              OLED_BuffShowPoint(x_sub_b, y_sub_a);        //2
  365   2              OLED_BuffShowPoint(x_add_a, y_add_b);        //7
  366   2              //é‡å†™ä»£ç ï¼Œé¿å…C251æŠ¥Warning
  367   2      
  368   2              a++;
  369   2       
  370   2              //ä½¿ç”¨Bresenhamç®—æ³•ç”»åœ†
  371   2              if (di < 0)di += 4 * a + 6;
  372   2              else
  373   2              {
  374   3                  di += 10 + 4 * (a - b);
  375   3                  b--;
  376   3              }
  377   2          }
  378   1      }
  379          
  380          //========================================================================
  381          // å‡½æ•°åç§°: OLED_BuffShowChar
  382          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€ä¸ª8*16çš„å­—ç¬¦
  383          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @asc:å­—ç¬¦   @modeï¼š0æ­£æ˜¾  1åæ˜¾
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 7   

  384          // å‡½æ•°è¿”å›: æ— 
  385          // å½“å‰ç‰ˆæœ¬: VER1.0
  386          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  387          // å½“å‰ä½œè€…: ZCF
  388          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  389          //========================================================================
  390          void OLED_BuffShowChar(unsigned char x,unsigned char y,char asc, unsigned char mode)     //OLEDæ˜¾ç¤ºä¸€ä
             -¸ª8*16å­—ç¬¦
  391          {
  392   1          unsigned char j,k;
  393   1          for( j=0;j<2;j++ )
  394   1          {
  395   2              for( k=0;k<8;k++ )
  396   2              {
  397   3                  if(mode==0)            
  398   3                      ShowBUFF[j+y][x+k]=Ascll_16[(asc-' ')*2][j*8+k];
  399   3                  else
  400   3                      ShowBUFF[j+y][x+k]=~Ascll_16[(asc-' ')*2][j*8+k];
  401   3              }
  402   2          }    
  403   1      }
  404          
  405          //========================================================================
  406          // å‡½æ•°åç§°: OLED_BuffShowGBK
  407          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºæ±‰å­—
  408          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @gbk:æ±‰å­—   @modeï¼š0æ­£æ˜¾  1åæ˜¾
  409          // å‡½æ•°è¿”å›: æ— 
  410          // å½“å‰ç‰ˆæœ¬: VER1.0
  411          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  412          // å½“å‰ä½œè€…: ZCF
  413          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  414          //          ç”¨åˆ°çš„æ±‰å­—éœ€è¦è‡ªå·±å–æ¨¡æ”¾åˆ°å­—åº“é‡Œï¼Œå­—åº“å¤šçš„è¯ï¼Œè¿™é‡Œè¿™ä¸ªå¾ªç¯å˜é‡
             -è¦æ”¾å¤§
  415          //========================================================================
  416          void OLED_BuffShowGBK(unsigned char x,unsigned char y,char *gbk,unsigned char mode)     //OLEDæ˜¾ç¤ºä¸€ä¸
             -ª16*16æ±‰å­—
  417          {
  418   1          unsigned char i;
  419   1          unsigned char j,k;
  420   1          for( i=0;i<200;i++ )
  421   1          {
  422   2              if(( gbk[0]== GBK16[i].gbn_bum[0] )&&( gbk[1]== GBK16[i].gbn_bum[1] ))
  423   2              {
  424   3                  for( j=0;j<2;j++ )
  425   3                  {
  426   4                      for( k=0;k<16;k++ )
  427   4                      {
  428   5                          if( mode ==0 )
  429   5                              ShowBUFF[j+y][x+k]=GBK16[i].gbk_font[j*16+k];
  430   5                          else
  431   5                              ShowBUFF[j+y][x+k]=~GBK16[i].gbk_font[j*16+k];
  432   5                      }
  433   4                  }
  434   3                  break;
  435   3              }
  436   2          }    
  437   1      }
  438          
  439          //========================================================================
  440          // å‡½æ•°åç§°: OLED_BuffShowString
  441          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºå­—ç¬¦ä¸²ã€‚æ±‰å­—å­—ç¬¦å‡å¯
  442          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @så­—ç¬¦ä¸²   @modeï¼š0æ­£æ˜¾  1åæ˜¾
  443          // å‡½æ•°è¿”å›: æ— 
  444          // å½“å‰ç‰ˆæœ¬: VER1.0
  445          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  446          // å½“å‰ä½œè€…: ZCF
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 8   

  447          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  448          //          ç”¨åˆ°çš„æ±‰å­—éœ€è¦è‡ªå·±å–æ¨¡æ”¾åˆ°å­—åº“é‡Œï¼Œå­—åº“å¤šçš„è¯ï¼Œè¿™é‡Œè¿™ä¸ªå¾ªç¯å˜é‡
             -è¦æ”¾å¤§
  449          //========================================================================
  450          void OLED_BuffShowString(unsigned char x,unsigned char y,char *s,unsigned char mode)
  451          {
  452   1          char s_num[2];
  453   1        while(*s != '\0')       //å­—ç¬¦ä¸²ä¸ä¸ºç©ºï¼Œå¾ªç¯
  454   1        {
  455   2              if ((unsigned char)*s < 0x80)     //æ ¹æ®è¾“å…¥æ•°æ®çš„å¤§å°åˆ¤æ–­æ˜¯å­—ç¬¦è¿˜æ˜¯æ±‰å­—ï¼Œ
  456   2              {
  457   3                  OLED_BuffShowChar(x,y,*s,mode);
  458   3                  x+=8;
  459   3                  s++;
  460   3              }
  461   2              else
  462   2              {
  463   3                  s_num[0] = *s ;
  464   3                  s_num[1] = *(s+1) ;
  465   3                  OLED_BuffShowGBK(x,y,s_num,mode);
  466   3                  x+=16;
  467   3                  s+=2;
  468   3              }
  469   2          if(x>127)
  470   2              {
  471   3                  x=0;
  472   3                  y+=2;
  473   3              }
  474   2        }       
  475   1      }
  476          
  477          //========================================================================
  478          // å‡½æ•°åç§°: OLED_BuffShowNum
  479          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºæ•´å½¢å˜é‡
  480          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @numï¼šæ•´å½¢å˜é‡   @modeï¼š0æ­£æ˜¾  1åæ˜¾
  481          // å‡½æ•°è¿”å›: æ— 
  482          // å½“å‰ç‰ˆæœ¬: VER1.1
  483          // ä¿®æ”¹æ—¥æœŸ: 2024 - 3 - 28
  484          // å½“å‰ä½œè€…: ZCF, PatZer0
  485          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  486          //========================================================================
  487          void OLED_BuffShowNum(unsigned char x,unsigned char y,long num,unsigned char mode)
  488          {
  489   1          unsigned char xdata str[10];
  490   1          memset(str,0,10);
  491   1          sprintf(str,"%ld",num);
  492   1          OLED_BuffShowString(x,y,(unsigned char*)str, mode);
  493   1      }
  494          
  495          //========================================================================
  496          // å‡½æ•°åç§°: OLED_BuffShowNum02F
  497          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤ºä¸€ä¸ªä¸¤ä½å°æ•°å˜é‡
  498          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @numï¼šå°æ•°å˜é‡   @modeï¼š0æ­£æ˜¾  1åæ˜¾
  499          // å‡½æ•°è¿”å›: æ— 
  500          // å½“å‰ç‰ˆæœ¬: VER1.0
  501          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  502          // å½“å‰ä½œè€…: ZCF
  503          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  504          //========================================================================
  505          void OLED_BuffShowNum02F(unsigned char x,unsigned char y,float num,unsigned char mode)
  506          {
  507   1          unsigned char xdata str[10];
  508   1          memset(str,0,10);
  509   1          sprintf(str,"%.2f",num);
  510   1          OLED_BuffShowString(x,y,(unsigned char*)str,mode);
  511   1      }
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 9   

  512          
  513          
  514          //========================================================================
  515          // å‡½æ•°åç§°: OLED_BuffShowChar32
  516          // å‡½æ•°åŠŸèƒ½: OLEDæ˜¾ç¤º16*32çš„å­—ç¬¦
  517          // å…¥å£å‚æ•°: @xï¼šxç‚¹  @yï¼šyç‚¹  @numï¼šæ˜¾ç¤ºç¬¬å‡ ä¸ªå­—ç¬¦   @modeï¼š0æ­£æ˜¾  1åæ˜¾
  518          // å‡½æ•°è¿”å›: æ— 
  519          // å½“å‰ç‰ˆæœ¬: VER1.0
  520          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  521          // å½“å‰ä½œè€…: ZCF
  522          // å…¶ä»–å¤‡æ³¨: å†™å…¥çš„æ˜¯ç¼“å­˜ï¼Œéœ€è¦ç”µè°ƒç”¨OLED_BuffShowæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥
  523          //          ç”¨åˆ°çš„éœ€è¦è‡ªå·±å–æ¨¡å“¦
  524          //========================================================================
  525          void OLED_BuffShowChar32(unsigned char  x,unsigned char  y,unsigned char num, unsigned char mode)     
  526          {
  527   1          unsigned char j,k;
  528   1          for( j=0;j<4;j++ )
  529   1          {
  530   2              for( k=0;k<16;k++ )
  531   2              {
  532   3                  if( mode==0 )
  533   3                      ShowBUFF[j+y][x+k]=lib_num1632[num][j*16+k];
  534   3                  else
  535   3                      ShowBUFF[j+y][x+k]=~lib_num1632[num][j*16+k];
  536   3              }
  537   2          }            
  538   1      }
  539          
  540          
  541          //========================================================================
  542          // å‡½æ•°åç§°: OLED_BuffShowBMP
  543          // å‡½æ•°åŠŸèƒ½: OLEDç¼“å­˜å†™å…¥å›¾ç‰‡
  544          // å…¥å£å‚æ•°: @x0:xèµ·ç‚¹  @y0:yèµ·ç‚¹    @x1:xç»ˆç‚¹   @y1:yç»ˆç‚¹  @BMPï¼šæ˜¾ç¤ºæ•°ç»„
  545          // å‡½æ•°è¿”å›: æ— 
  546          // å½“å‰ç‰ˆæœ¬: VER1.0
  547          // ä¿®æ”¹æ—¥æœŸ: 2023 - 6 - 7
  548          // å½“å‰ä½œè€…: ZCF
  549          // å…¶ä»–å¤‡æ³¨:
  550          //========================================================================
  551          void OLED_BuffShowBMP(unsigned char x0, unsigned char y0,unsigned char x1, unsigned char y1,unsigned char
             - BMP[])
  552          {   
  553   1          unsigned int xdata num=0;
  554   1          unsigned char k,j;
  555   1          
  556   1          for( j=0;j<y1;j++ )
  557   1          {
  558   2              for( k=0;k<x1;k++ )
  559   2              {
  560   3                  ShowBUFF[j+y0][x0+k]=BMP[num++];
  561   3              }
  562   2          }  
  563   1      } 
  564           


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      5286     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =      1024         23
  xdata-const size     =    ------     ------
  edata size           =    ------         33
  bit size             =    ------     ------
C251 COMPILER V5.60.0,  oled                                                               29/03/24  09:18:42  PAGE 10  

  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         9     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
